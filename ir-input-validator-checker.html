<dom-module is="ir-input-validator-checker">
	<template>

		<span id="invalidForm" hidden="{{ isValid }}">
			<content></content>
		</span>

	</template>
</dom-module>

<style>
	ir-input-validator-checker, :host{
		float: right;
	}
	#invalidForm{
		color: red;
	}

</style>

<script>
if(!window.ir) window.ir = {};

Polymer({
	is : "ir-input-validator-checker",
	attached : function() {

		var that = this, validators, form;

		form = this;
		while(form.tagName != 'FORM')
			form = form.parentNode;

		if(!form)
			return console.warn("ir-input-validator-checker couldn't find an ancestor form and will do nothing: ", this);

		validators = [].slice.call(form.querySelectorAll('ir-input-validator'));
		this.set("validators", validators);
		
		form.addEventListener('check-form', this.digestValidators.bind(this));
		
		//validators.forEach(function(v) { ); }.bind(this));
	},
	
	digestValidators : function() {
		var digest = this.validators.reduce(function(r, v) { return r + (v.isValid ? 0 : 1) }, 0);
		this.set('isValid', !digest);
		this.set('errorsCount', digest);
	},

	properties : {
		isValid : { type : Boolean, value : true},
		validators : { type : Object },
		errorsCount : { type:Number, value : 0}
	}
});
</script>
